<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine ‚ú®</title>
  <style>
    :root{
      --bg1:#fff0f6;
      --bg2:#ffe3ee;
      --ink:#2b1b2a;
      --pink:#ff4d8d;
      --hot:#ff2e7a;
      --rose:#ff7aa8;
      --card: rgba(255,255,255,.78);
      --shadow: 0 20px 60px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 20% 10%, #fff 0%, transparent 60%),
        radial-gradient(900px 600px at 90% 20%, #fff 0%, transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    /* Floating hearts background */
    .hearts{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.08));
    }
    .heart{
      position:absolute;
      width:18px; height:18px;
      transform: rotate(45deg);
      background: linear-gradient(135deg, #ff6aa2, #ff2e7a);
      border-radius: 4px;
      opacity:.55;
      animation: floatUp linear infinite;
    }
    .heart:before,.heart:after{
      content:"";
      position:absolute;
      width:18px;height:18px;
      background: inherit;
      border-radius:50%;
    }
    .heart:before{left:-9px; top:0}
    .heart:after{top:-9px; left:0}

    @keyframes floatUp{
      from{ transform: translateY(110vh) rotate(45deg) scale(var(--s,1)); opacity:0 }
      10%{opacity:.55}
      to{ transform: translateY(-20vh) rotate(45deg) scale(var(--s,1)); opacity:0 }
    }

    /* Page framework */
    .app{
      position:relative;
      z-index:1;
      height:100%;
      display:grid;
      place-items:center;
      padding:24px;
    }
    .page{
      width:min(920px, 94vw);
      background: var(--card);
      border: 1px solid rgba(255,255,255,.7);
      border-radius: 28px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 26px;
      display:none;
      position:relative;
      overflow:hidden;
    }
    .page.active{display:block}
    .page::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(200px 200px at 15% 15%, rgba(255,77,141,.25), transparent 60%),
        radial-gradient(240px 240px at 85% 25%, rgba(255,46,122,.22), transparent 65%),
        radial-gradient(280px 280px at 55% 110%, rgba(255,122,168,.20), transparent 55%);
      pointer-events:none;
      z-index:0;
    }
    .content{position:relative; z-index:1}

    header{
      display:flex; gap:18px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:16px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .badge{
      width:44px; height:44px;
      border-radius:14px;
      background: linear-gradient(135deg, var(--hot), var(--rose));
      display:grid; place-items:center;
      color:white;
      box-shadow: 0 12px 24px rgba(255,46,122,.28);
      position:relative;
      overflow:hidden;
    }
    .badge::after{
      content:"";
      position:absolute; inset:-40%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.55), transparent);
      transform: rotate(25deg);
      animation: sheen 2.7s infinite;
    }
    @keyframes sheen{
      0%{transform:translateX(-60%) rotate(25deg)}
      60%{transform:translateX(80%) rotate(25deg)}
      100%{transform:translateX(80%) rotate(25deg)}
    }
    h1{
      margin:0;
      font-size: clamp(26px, 4vw, 40px);
      line-height:1.05;
      letter-spacing:-0.02em;
    }
    .subtitle{
      margin:6px 0 0;
      opacity:.8;
      font-size: 14.5px;
    }

    .pill{
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255,255,255,.7);
      border:1px solid rgba(255,255,255,.8);
      font-size:13px;
      display:flex; gap:8px; align-items:center;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      margin-top:14px;
    }
    @media (max-width:860px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      background: rgba(255,255,255,.68);
      border:1px solid rgba(255,255,255,.75);
      border-radius:22px;
      padding:18px;
    }

    .inputRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    input{
      flex:1 1 220px;
      padding:14px 14px;
      border-radius:14px;
      border:1px solid rgba(43,27,42,.15);
      background: rgba(255,255,255,.8);
      outline:none;
      font-size:16px;
    }
    input:focus{
      border-color: rgba(255,46,122,.5);
      box-shadow: 0 0 0 4px rgba(255,46,122,.12);
    }

    button{
      border:0;
      cursor:pointer;
      border-radius:14px;
      padding:14px 16px;
      font-weight:700;
      font-size:15.5px;
      letter-spacing:.01em;
      transition: transform .08s ease, filter .2s ease;
      user-select:none;
    }
    button:active{transform: translateY(1px) scale(.99)}
    .btnPrimary{
      background: linear-gradient(135deg, var(--hot), var(--rose));
      color:white;
      box-shadow: 0 14px 30px rgba(255,46,122,.26);
    }
    .btnGhost{
      background: rgba(255,255,255,.75);
      border: 1px solid rgba(43,27,42,.12);
      color: var(--ink);
    }
    .btnDanger{
      background: linear-gradient(135deg, #7c3aed, #ff2e7a);
      color:white;
      box-shadow: 0 14px 30px rgba(124,58,237,.18);
    }

    .msg{
      margin-top:10px;
      font-size:14px;
      min-height:20px;
    }
    .msg.good{color:#0a7a4b}
    .msg.bad{color:#b42318}

    /* Cute illustration (pure CSS-ish) */
    .cuteWrap{
      display:grid;
      place-items:center;
      padding:8px 0;
    }
    .cute{
      width:min(320px, 72vw);
      aspect-ratio: 1.2/1;
      position:relative;
    }
    .blob{
      position:absolute; inset:0;
      border-radius: 35% 65% 55% 45% / 45% 45% 55% 55%;
      background: radial-gradient(circle at 30% 20%, #fff, transparent 45%),
                  linear-gradient(135deg, rgba(255,46,122,.35), rgba(255,122,168,.35));
      filter: blur(.2px);
      animation: wobble 6s ease-in-out infinite;
    }
    @keyframes wobble{
      0%,100%{transform: rotate(-2deg) scale(1)}
      50%{transform: rotate(2deg) scale(1.02)}
    }
    .bear{
      position:absolute;
      left:50%; top:52%;
      transform: translate(-50%,-50%);
      width:62%;
      height:62%;
    }
    .head{
      position:absolute; inset: 14% 12% 16% 12%;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(43,27,42,.10);
      border-radius: 38% 38% 42% 42% / 44% 44% 56% 56%;
      box-shadow: 0 16px 40px rgba(0,0,0,.08);
    }
    .ear{
      position:absolute; top:8%;
      width:22%; height:22%;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(43,27,42,.10);
      border-radius: 50%;
    }
    .ear.left{left:10%}
    .ear.right{right:10%}
    .ear::after{
      content:"";
      position:absolute; inset:28%;
      border-radius:50%;
      background: rgba(255,46,122,.12);
    }
    .face{
      position:absolute; inset: 34% 18% 20% 18%;
    }
    .eye{
      position:absolute; top:18%;
      width:14%; height:18%;
      background: var(--ink);
      border-radius: 999px;
    }
    .eye.left{left:22%}
    .eye.right{right:22%}
    .sparkle{
      position:absolute; width:35%; height:35%;
      background: rgba(255,255,255,.9);
      border-radius: 50%;
      top:10%; left:55%;
      transform: rotate(15deg);
    }
    .cheek{
      position:absolute; top:50%;
      width:18%; height:18%;
      background: rgba(255,46,122,.16);
      border-radius: 999px;
      filter: blur(.2px);
    }
    .cheek.left{left:10%}
    .cheek.right{right:10%}
    .nose{
      position:absolute; left:50%; top:48%;
      transform: translateX(-50%);
      width:16%; height:12%;
      background: rgba(43,27,42,.85);
      border-radius: 0 0 14px 14px / 0 0 18px 18px;
    }
    .smile{
      position:absolute; left:50%; top:58%;
      transform: translateX(-50%);
      width:28%; height:20%;
      border-bottom: 3px solid rgba(43,27,42,.75);
      border-radius: 0 0 70px 70px;
      opacity:.9;
    }
    .floatingMiniHeart{
      position:absolute;
      width:18px; height:18px;
      left:78%; top:14%;
      transform: rotate(45deg);
      background: linear-gradient(135deg, #ff6aa2, #ff2e7a);
      border-radius: 4px;
      animation: pop 1.8s ease-in-out infinite;
    }
    .floatingMiniHeart:before,.floatingMiniHeart:after{
      content:"";
      position:absolute;
      width:18px;height:18px;
      background:inherit;
      border-radius:50%;
    }
    .floatingMiniHeart:before{left:-9px; top:0}
    .floatingMiniHeart:after{top:-9px; left:0}
    @keyframes pop{
      0%,100%{transform: translateY(0) rotate(45deg) scale(1)}
      50%{transform: translateY(-10px) rotate(45deg) scale(1.08)}
    }

    /* Question page */
    .bigQ{
      font-size: clamp(28px, 4.5vw, 52px);
      line-height: 1.02;
      margin: 8px 0 10px;
      letter-spacing: -0.03em;
    }
    .nameTag{
      display:inline-flex; gap:8px; align-items:center;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,255,255,.75);
      border:1px solid rgba(43,27,42,.12);
      font-weight:700;
      margin-top:6px;
    }
    .btnRow{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:14px;
      align-items:center;
    }
    .tinyNote{
      opacity:.75;
      font-size:13px;
      margin-top:10px;
    }

    /* Fireworks page */
    .fireworksWrap{
      position:relative;
      height: min(70vh, 520px);
      border-radius: 22px;
      overflow:hidden;
      background: radial-gradient(900px 420px at 50% 30%, rgba(255,255,255,.18), transparent 60%),
                  linear-gradient(180deg, #14021b, #250028, #38001f);
      border: 1px solid rgba(255,255,255,.12);
    }
    canvas{display:block; width:100%; height:100%}

    .overlayLove{
      position:absolute; inset:0;
      display:grid; place-items:center;
      pointer-events:none;
      text-align:center;
      padding:18px;
    }
    .loveTitle{
      font-size: clamp(30px, 5vw, 60px);
      margin:0;
      color: rgba(255,255,255,.96);
      text-shadow: 0 10px 40px rgba(0,0,0,.35);
      letter-spacing:-0.03em;
    }
    .loveSub{
      margin:10px 0 0;
      color: rgba(255,255,255,.88);
      font-size: 15px;
      opacity:.95;
    }

    /* "No" page shenanigans */
    .sadStage{
      position:relative;
      height: min(64vh, 460px);
      border-radius: 22px;
      overflow:hidden;
      background: radial-gradient(900px 500px at 40% 30%, rgba(255,255,255,.22), transparent 62%),
                  linear-gradient(180deg, #0b1020, #0a1a1a);
      border: 1px solid rgba(255,255,255,.12);
    }
    .rain{
      position:absolute; inset:0;
      background:
        repeating-linear-gradient(100deg,
          rgba(173,216,230,.0) 0px,
          rgba(173,216,230,.0) 12px,
          rgba(173,216,230,.14) 12px,
          rgba(173,216,230,.14) 13px);
      animation: rainMove 0.9s linear infinite;
      opacity:.9;
      mix-blend-mode: screen;
    }
    @keyframes rainMove{
      from{background-position:0 0}
      to{background-position: 40px 120px}
    }
    .noCenter{
      position:absolute; inset:0;
      display:grid; place-items:center;
      text-align:center;
      padding:18px;
      color:rgba(255,255,255,.92);
    }
    .noTitle{
      margin:0;
      font-size: clamp(26px, 4.2vw, 52px);
      letter-spacing:-0.03em;
      text-shadow: 0 10px 40px rgba(0,0,0,.35);
    }
    .noText{
      margin:10px auto 0;
      max-width: 56ch;
      color: rgba(255,255,255,.84);
      font-size: 15px;
      line-height:1.45;
    }
    .tinyBtnRow{
      display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
      margin-top:16px;
      pointer-events:auto;
    }

    /* Footer */
    .footer{
      margin-top: 14px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      opacity:.75;
      font-size:12.5px;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      padding: 2px 6px;
      border-radius: 8px;
      background: rgba(255,255,255,.72);
      border:1px solid rgba(43,27,42,.12);
    }
  </style>
</head>
<body>

  <div class="hearts" id="hearts"></div>

  <div class="app">
    <!-- PAGE 1: Name gate -->
    <section class="page active" id="page-name">
      <div class="content">
        <header>
          <div class="brand">
            <div class="badge" aria-hidden="true">‚ù§</div>
            <div>
              <h1>Valentine Access Portal</h1>
              <p class="subtitle">Enter the secret name to unlock the cute stuff ‚ú®</p>
            </div>
          </div>
          <div class="pill" title="Hint">
            <span aria-hidden="true">üîí</span>
            <span>Tip: set the correct name in the code</span>
          </div>
        </header>

        <div class="grid">
          <div class="card">
            <div style="font-weight:800; font-size:18px;">What‚Äôs your name?</div>
            <div class="subtitle">Be honest. The hearts are watching.</div>

            <div class="inputRow">
              <input id="nameInput" placeholder="Type the name here‚Ä¶" autocomplete="off" />
              <button class="btnPrimary" id="unlockBtn">Unlock üíò</button>
              <button class="btnGhost" id="randomBtn" title="Just for fun">Sprinkle Hearts</button>
            </div>

            <div class="msg" id="nameMsg"></div>

            <div class="footer">
              <div>Press <span class="kbd">Enter</span> to submit</div>
              <div>Made with maximum romantic effort‚Ñ¢</div>
            </div>
          </div>

          <div class="card cuteWrap">
            <div class="cute" aria-hidden="true">
              <div class="blob"></div>
              <div class="floatingMiniHeart"></div>
              <div class="bear">
                <div class="ear left"></div>
                <div class="ear right"></div>
                <div class="head">
                  <div class="face">
                    <div class="eye left"><div class="sparkle"></div></div>
                    <div class="eye right"><div class="sparkle"></div></div>
                    <div class="cheek left"></div>
                    <div class="cheek right"></div>
                    <div class="nose"></div>
                    <div class="smile"></div>
                  </div>
                </div>
              </div>
            </div>
            <div style="margin-top:10px; font-weight:800;">Cute Bear Guard</div>
            <div class="subtitle" style="text-align:center">Only lets the right name pass üêªüíó</div>
          </div>
        </div>
      </div>
    </section>

    <!-- PAGE 2: Question -->
    <section class="page" id="page-question">
      <div class="content">
        <header>
          <div class="brand">
            <div class="badge" aria-hidden="true">üíå</div>
            <div>
              <h1>One Important Question‚Ä¶</h1>
              <p class="subtitle">No pressure (okay maybe a tiny bit).</p>
            </div>
          </div>
          <div class="nameTag" id="whoTag">üë§</div>
        </header>

        <div class="grid">
          <div class="card">
            <div class="bigQ">Will you be my valentine? üíò</div>
            <div class="subtitle">Pick wisely. The universe is taking notes.</div>

            <div class="btnRow">
              <button class="btnPrimary" id="yesBtn">YES!! üéÜ</button>
              <button class="btnGhost" id="noBtn">No üò∂</button>
              <button class="btnGhost" id="backBtn">Back</button>
            </div>

            <div class="tinyNote">
              Pro tip: ‚ÄúYes‚Äù has fireworks. ‚ÄúNo‚Äù has‚Ä¶ consequences. (Cute ones.)
            </div>
          </div>

          <div class="card">
            <div style="font-weight:900; font-size:18px;">A tiny poem</div>
            <div class="subtitle" style="margin-top:10px; line-height:1.55">
              Roses are red,<br/>
              Violets are blue,<br/>
              I made this lil‚Äô page<br/>
              Just to ask you üíó
            </div>
            <div style="margin-top:14px; opacity:.8; font-size:13px">
              (Yes, I coded the hearts. Yes, they‚Äôre adorable.)
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PAGE 3: YES - Fireworks + image -->
    <section class="page" id="page-yes">
      <div class="content">
        <header>
          <div class="brand">
            <div class="badge" aria-hidden="true">üéá</div>
            <div>
              <h1>YAAAY!! üíñ</h1>
              <p class="subtitle">Okay hold still while the sky celebrates.</p>
            </div>
          </div>
          <div class="pill"><span aria-hidden="true">‚ú®</span><span>Fireworks mode: ON</span></div>
        </header>

        <div class="fireworksWrap" id="fwWrap">
          <canvas id="fw"></canvas>
          <div class="overlayLove">
            <div>
              <h2 class="loveTitle">Happy Valentine‚Äôs! üíû</h2>
              <p class="loveSub" id="loveSub">You just made my whole day.</p>
            </div>
          </div>
        </div>

        <div class="btnRow" style="margin-top:14px">
          <button class="btnPrimary" id="replayBtn">Replay Fireworks üéÜ</button>
          <button class="btnGhost" id="yesBackBtn">Back</button>
        </div>
      </div>
    </section>

    <!-- PAGE 4: NO - show skills -->
    <section class="page" id="page-no">
      <div class="content">
        <header>
          <div class="brand">
            <div class="badge" aria-hidden="true">ü´†</div>
            <div>
              <h1>Oh. Okay. üò≠</h1>
              <p class="subtitle">It‚Äôs fine. I‚Äôm totally fine. (I‚Äôm not.)</p>
            </div>
          </div>
          <div class="pill"><span aria-hidden="true">üåßÔ∏è</span><span>Drama weather enabled</span></div>
        </header>

        <div class="sadStage">
          <div class="rain"></div>
          <div class="noCenter">
            <div>
              <h2 class="noTitle" id="noTitle">My heart just did a lil‚Äô backflip.</h2>
              <p class="noText" id="noText">
                But hey‚Äîyour honesty is valid. To cope, I have hired a professional cloud to rain gently,
                and I will now attempt to bribe you with a mini game:
                press ‚ÄúRedeem‚Äù and I‚Äôll make the ‚ÄúNO‚Äù button run away next time. üòà
              </p>
              <div class="tinyBtnRow">
                <button class="btnDanger" id="redeemBtn">Redeem üòà</button>
                <button class="btnGhost" id="tryAgainBtn">Try Again üíò</button>
                <button class="btnGhost" id="noBackBtn">Back</button>
              </div>
              <div class="tinyNote" id="redeemNote" style="color:rgba(255,255,255,.82)"></div>
            </div>
          </div>
        </div>

      </div>
    </section>
  </div>

  <script>
    /***********************
     * CONFIG YOU SHOULD EDIT
     ***********************/
    // Set this to the EXACT name you want to accept:
    const CORRECT_NAME = "Reem"; // <-- change me (example: "Aisha")

    /***********************
     * Simple page router
     ***********************/
    const pages = {
      name: document.getElementById("page-name"),
      question: document.getElementById("page-question"),
      yes: document.getElementById("page-yes"),
      no: document.getElementById("page-no"),
    };

    function showPage(key){
      Object.values(pages).forEach(p => p.classList.remove("active"));
      pages[key].classList.add("active");

      // start/stop fireworks depending on page
      if(key === "yes"){
        startFireworks();
      } else {
        stopFireworks();
      }
    }

    /***********************
     * Floating hearts generator
     ***********************/
    const hearts = document.getElementById("hearts");
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const left = Math.random()*100;
      const dur = 7 + Math.random()*7;
      const size = 0.7 + Math.random()*1.9;
      h.style.left = left + "vw";
      h.style.animationDuration = dur + "s";
      h.style.setProperty("--s", size);
      h.style.filter = `blur(${Math.random()*0.6}px)`;
      hearts.appendChild(h);
      setTimeout(()=>h.remove(), dur*1000);
    }
    // steady stream
    let heartInterval = setInterval(spawnHeart, 260);
    // initial burst
    for(let i=0;i<20;i++) setTimeout(spawnHeart, i*60);

    /***********************
     * Name gate logic
     ***********************/
    const nameInput = document.getElementById("nameInput");
    const unlockBtn = document.getElementById("unlockBtn");
    const randomBtn = document.getElementById("randomBtn");
    const nameMsg = document.getElementById("nameMsg");
    const whoTag = document.getElementById("whoTag");

    let acceptedName = "";

    function normalize(s){
      return (s || "").trim().toLowerCase();
    }

    function tryUnlock(){
      const typed = nameInput.value.trim();
      if(!typed){
        nameMsg.textContent = "Psst‚Ä¶ type a name first üíó";
        nameMsg.className = "msg bad";
        return;
      }
      if(normalize(typed) === normalize(CORRECT_NAME)){
        acceptedName = typed;
        whoTag.textContent = "üë§ " + acceptedName;
        nameMsg.textContent = "Correct! Proceeding to the question‚Ä¶ üíò";
        nameMsg.className = "msg good";
        setTimeout(()=>showPage("question"), 650);
      } else {
        // playful wrong answer responses
        const lines = [
          "Hmm‚Ä¶ that name feels suspiciously incorrect üëÄ",
          "Close‚Ä¶ (or not). Try again üòÖ",
          "The bear says: nope üêª",
          "Not the secret name! The hearts demand accuracy üíó",
        ];
        nameMsg.textContent = lines[Math.floor(Math.random()*lines.length)];
        nameMsg.className = "msg bad";
        // tiny shake effect
        pages.name.animate(
          [{transform:"translateX(0)"},{transform:"translateX(-6px)"},{transform:"translateX(6px)"},{transform:"translateX(0)"}],
          {duration:220, iterations:1}
        );
      }
    }

    unlockBtn.addEventListener("click", tryUnlock);
    nameInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") tryUnlock();
    });

    randomBtn.addEventListener("click", ()=>{
      for(let i=0;i<18;i++) setTimeout(spawnHeart, i*40);
      nameMsg.textContent = "Heart confetti deployed ‚úÖ";
      nameMsg.className = "msg good";
    });

    /***********************
     * Question page logic
     ***********************/
    const yesBtn = document.getElementById("yesBtn");
    const noBtn  = document.getElementById("noBtn");
    const backBtn= document.getElementById("backBtn");

    let noRunsAway = false;

    backBtn.addEventListener("click", ()=>showPage("name"));
    yesBtn.addEventListener("click", ()=>showPage("yes"));
    noBtn.addEventListener("click", ()=>showPage("no"));

    // "show skills": if redeemed, NO button runs away playfully
    function makeNoButtonSkittish(){
      const pad = 10;
      const parent = noBtn.parentElement;
      parent.style.position = "relative";
      noBtn.style.position = "relative";

      function dodge(){
        const w = parent.clientWidth - noBtn.offsetWidth - pad*2;
        const h = 160; // vertical playground
        const x = (Math.random()*w) - w/2;
        const y = (Math.random()*h) - h/3;
        noBtn.animate([{transform:`translate(${x}px, ${y}px)`}], {duration:160, fill:"forwards", easing:"ease-out"});
      }
      noBtn.addEventListener("mouseenter", dodge);
      noBtn.addEventListener("touchstart", (e)=>{ e.preventDefault(); dodge(); }, {passive:false});
    }

    /***********************
     * YES page fireworks (canvas)
     ***********************/
    const canvas = document.getElementById("fw");
    const ctx = canvas.getContext("2d");
    let fwRAF = null;
    let particles = [];
    let rockets = [];
    let lastT = 0;

    function resizeCanvas(){
      const wrap = document.getElementById("fwWrap");
      const r = wrap.getBoundingClientRect();
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      canvas.width = Math.floor(r.width * dpr);
      canvas.height = Math.floor(r.height * dpr);
      canvas.style.width = r.width + "px";
      canvas.style.height = r.height + "px";
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener("resize", resizeCanvas);

    function rand(min,max){ return min + Math.random()*(max-min); }

    function launchRocket(){
      const w = canvas.clientWidth;
      const h = canvas.clientHeight;
      rockets.push({
        x: rand(w*0.15, w*0.85),
        y: h + 10,
        vx: rand(-0.6, 0.6),
        vy: rand(-8.6, -11.2),
        targetY: rand(h*0.18, h*0.45),
        hue: rand(315, 360), // pink-ish
      });
    }

    function explode(x,y,hue){
      const count = Math.floor(rand(44, 78));
      for(let i=0;i<count;i++){
        const a = rand(0, Math.PI*2);
        const sp = rand(1.2, 5.8) * (Math.random()<0.18 ? 1.7 : 1);
        particles.push({
          x,y,
          vx: Math.cos(a)*sp,
          vy: Math.sin(a)*sp,
          life: rand(0.9, 1.6),
          age: 0,
          hue: hue + rand(-18, 18),
          size: rand(1.2, 2.6),
          drag: 0.985,
          gravity: 0.06,
          sparkle: Math.random()<0.25
        });
      }
      // tiny heart burst for extra valentine energy
      for(let i=0;i<8;i++){
        const a = rand(0, Math.PI*2);
        const sp = rand(1.0, 3.2);
        particles.push({
          x,y,
          vx: Math.cos(a)*sp,
          vy: Math.sin(a)*sp,
          life: rand(1.0, 1.8),
          age: 0,
          hue: rand(330, 360),
          size: rand(2.2, 3.2),
          drag: 0.99,
          gravity: 0.045,
          heart: true
        });
      }
    }

    function drawHeartParticle(p){
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(Math.PI/4);
      const s = p.size*1.8;
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.rect(-s/2, -s/2, s, s);
      ctx.fill();
      // circles
      ctx.beginPath();
      ctx.arc(-s/2, 0, s/2, 0, Math.PI*2);
      ctx.arc(0, -s/2, s/2, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }

    function tickFireworks(t){
      const dt = Math.min(0.033, (t - lastT)/1000 || 0.016);
      lastT = t;

      const w = canvas.clientWidth;
      const h = canvas.clientHeight;

      // fade frame
      ctx.fillStyle = "rgba(0,0,0,0.18)";
      ctx.fillRect(0,0,w,h);

      // occasional launches
      if(Math.random() < 0.07) launchRocket();
      if(rockets.length < 2 && Math.random() < 0.5) launchRocket();

      // rockets
      for(let i=rockets.length-1;i>=0;i--){
        const r = rockets[i];
        r.x += r.vx;
        r.y += r.vy;
        r.vy += 0.08; // gravity
        // trail
        ctx.beginPath();
        ctx.strokeStyle = `hsla(${r.hue}, 95%, 70%, 0.75)`;
        ctx.lineWidth = 2;
        ctx.moveTo(r.x, r.y);
        ctx.lineTo(r.x - r.vx*2.4, r.y - r.vy*2.4);
        ctx.stroke();

        if(r.y <= r.targetY || r.vy >= -1.4){
          explode(r.x, r.y, r.hue);
          rockets.splice(i,1);
        }
      }

      // particles
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.age += dt;
        if(p.age > p.life){
          particles.splice(i,1);
          continue;
        }
        p.vx *= p.drag;
        p.vy = p.vy*p.drag + p.gravity;
        p.x += p.vx;
        p.y += p.vy;

        const alpha = 1 - (p.age/p.life);
        const bright = p.sparkle && Math.random()<0.25 ? 88 : 70;
        ctx.fillStyle = `hsla(${p.hue}, 100%, ${bright}%, ${alpha})`;

        if(p.heart){
          drawHeartParticle(p);
        } else {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
          ctx.fill();
        }
      }

      fwRAF = requestAnimationFrame(tickFireworks);
    }

    function startFireworks(){
      resizeCanvas();
      // reset and launch a small celebration immediately
      particles = [];
      rockets = [];
      for(let i=0;i<3;i++) launchRocket();
      if(!fwRAF){
        ctx.fillStyle = "rgba(0,0,0,1)";
        ctx.fillRect(0,0,canvas.clientWidth, canvas.clientHeight);
        lastT = 0;
        fwRAF = requestAnimationFrame(tickFireworks);
      }
      // personalized line
      const loveSub = document.getElementById("loveSub");
      loveSub.textContent = acceptedName
        ? `Officially yours, ${acceptedName} üíó`
        : `Officially yours üíó`;
    }

    function stopFireworks(){
      if(fwRAF){
        cancelAnimationFrame(fwRAF);
        fwRAF = null;
      }
    }

    document.getElementById("replayBtn").addEventListener("click", ()=>{
      // quick burst
      for(let i=0;i<6;i++) setTimeout(launchRocket, i*140);
    });
    document.getElementById("yesBackBtn").addEventListener("click", ()=>showPage("question"));

    /***********************
     * NO page logic
     ***********************/
    const redeemBtn = document.getElementById("redeemBtn");
    const tryAgainBtn = document.getElementById("tryAgainBtn");
    const noBackBtn = document.getElementById("noBackBtn");
    const redeemNote = document.getElementById("redeemNote");
    const noTitle = document.getElementById("noTitle");
    const noText = document.getElementById("noText");

    redeemBtn.addEventListener("click", ()=>{
      noRunsAway = true;
      redeemNote.textContent = "Redeemed ‚úÖ Next time, the NO button will panic and run away.";
      noTitle.textContent = "Plot twist: I respect your choice‚Ä¶";
      noText.textContent =
        "‚Ä¶but I also installed a playful anti-no system. It‚Äôs not mind control. It‚Äôs just ‚ú®chaos‚ú®. " +
        "Go back and try hovering the NO button. üòà";
      if(!noBtn.dataset.skittish){
        makeNoButtonSkittish();
        noBtn.dataset.skittish = "1";
      }
      // little heart burst even in sadness
      for(let i=0;i<12;i++) setTimeout(spawnHeart, i*50);
    });

    tryAgainBtn.addEventListener("click", ()=>showPage("question"));
    noBackBtn.addEventListener("click", ()=>showPage("question"));

    /***********************
     * Small safety: block question page if name not accepted
     ***********************/
    const originalShowPage = showPage;
    showPage = function(key){
      if((key === "question" || key === "yes" || key === "no") && !acceptedName){
        // if they try to jump without unlocking
        pages.name.classList.add("active");
        pages.question.classList.remove("active");
        pages.yes.classList.remove("active");
        pages.no.classList.remove("active");
        nameMsg.textContent = "Nice try üòÑ Unlock it with the correct name first!";
        nameMsg.className = "msg bad";
        return;
      }
      originalShowPage(key);
    };

    /***********************
     * Optional: make NO button only run away if redeemed
     ***********************/
    // If redeemed, enable skittish behavior (already handled above).
    // Otherwise, it's a normal button.

  </script>
</body>
</html>
